<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarineMaster Pro - Shipping Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --secondary: #0f172a;
            --accent: #22d3ee;
            --light: #f8fafc;
            --dark: #1e293b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --gray: #94a3b8;
            --light-gray: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f1f5f9;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 260px;
            background: var(--secondary);
            color: white;
            padding: 20px 0;
            transition: all 0.3s ease;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .logo {
            display: flex;
            align-items: center;
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo i {
            font-size: 28px;
            margin-right: 10px;
            color: var(--accent);
        }

        .logo h1 {
            font-size: 22px;
            font-weight: 700;
        }

        .nav-links {
            margin-top: 30px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-item.active, .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-left: 4px solid var(--accent);
        }

        .nav-item i {
            margin-right: 15px;
            font-size: 18px;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 20px;
            margin-left: 260px;
            overflow-y: auto;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray);
        }

        .header h2 {
            font-size: 24px;
            font-weight: 600;
            color: var(--secondary);
        }

        .user-info {
            display: flex;
            align-items: center;
        }

        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }

        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .stat-card {
            display: flex;
            align-items: center;
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 24px;
        }

        .stat-icon.blue {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary);
        }

        .stat-icon.green {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .stat-icon.orange {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .stat-info h3 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-info p {
            color: var(--gray);
            font-size: 14px;
        }

        /* Section Styles */
        .section {
            margin-bottom: 30px;
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--secondary);
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn i {
            margin-right: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #0d9669;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        /* Table Styles */
        .table-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        thead {
            background: var(--primary);
            color: white;
        }

        th, td {
            padding: 15px 20px;
            text-align: left;
        }

        tbody tr {
            border-bottom: 1px solid var(--light-gray);
        }

        tbody tr:last-child {
            border-bottom: none;
        }

        tbody tr:hover {
            background: #f8fafc;
        }

        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
        }

        .status.active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status.inactive {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .status.pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .status.maintenance {
            background: rgba(147, 51, 234, 0.1);
            color: #9333ea;
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            margin-right: 10px;
            color: var(--primary);
            font-size: 16px;
        }

        .action-btn.edit {
            color: var(--warning);
        }

        .action-btn.delete {
            color: var(--danger);
        }

        /* Form Styles */
        .form-container {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .search-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            display: none;
        }

        .modal {
            background: white;
            border-radius: 12px;
            width: 600px;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light-gray);
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--light-gray);
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            font-weight: 500;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Accounting Cards */
        .accounting-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .accounting-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .accounting-card h3 {
            font-size: 20px;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .accounting-card .amount {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .accounting-card .amount.income {
            color: var(--success);
        }

        .accounting-card .amount.expense {
            color: var(--danger);
        }

        .accounting-card .amount.profit {
            color: var(--primary);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            z-index: 2000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--danger);
        }

        .toast i {
            margin-right: 10px;
            font-size: 20px;
        }

        .toast.success i {
            color: var(--success);
        }

        .toast.error i {
            color: var(--danger);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .sidebar {
                width: 220px;
            }
            
            .main-content {
                margin-left: 220px;
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                width: 80px;
                z-index: 100;
            }
            
            .sidebar .logo h1, .sidebar .nav-item span {
                display: none;
            }
            
            .sidebar .logo {
                justify-content: center;
                padding: 15px 0;
            }
            
            .sidebar .nav-item {
                justify-content: center;
            }
            
            .sidebar .nav-item i {
                margin-right: 0;
            }
            
            .main-content {
                margin-left: 80px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                bottom: 0;
                top: auto;
                padding: 10px;
            }
            
            .nav-links {
                display: flex;
                margin-top: 0;
                justify-content: space-around;
            }
            
            .nav-item {
                padding: 10px;
                margin: 0;
            }
            
            .main-content {
                margin-left: 0;
                margin-bottom: 80px;
            }
            
            .dashboard-cards, .accounting-cards {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .user-info {
                margin-top: 15px;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .section-header .btn {
                margin-top: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-ship"></i>
                <h1>MarineMaster Pro</h1>
            </div>
            <div class="nav-links">
                <div class="nav-item active" data-section="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </div>
                <div class="nav-item" data-section="fleet">
                    <i class="fas fa-ship"></i>
                    <span>Fleet Management</span>
                </div>
                <div class="nav-item" data-section="cargo">
                    <i class="fas fa-box"></i>
                    <span>Cargo Operations</span>
                </div>
                <div class="nav-item" data-section="maintenance">
                    <i class="fas fa-tools"></i>
                    <span>Maintenance</span>
                </div>
                <div class="nav-item" data-section="accounting">
                    <i class="fas fa-calculator"></i>
                    <span>Accounting</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h2 id="section-title">Shipping Dashboard</h2>
                <div class="user-info">
                    <img src="https://ui-avatars.com/api/?name=Admin+User&background=2563eb&color=fff" alt="User">
                    <span>Admin User</span>
                </div>
            </div>

            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <div class="dashboard-cards">
                    <div class="card stat-card">
                        <div class="stat-icon blue">
                            <i class="fas fa-ship"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-vessels">24</h3>
                            <p>Total Vessels</p>
                        </div>
                    </div>
                    <div class="card stat-card">
                        <div class="stat-icon green">
                            <i class="fas fa-box"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-cargos">142</h3>
                            <p>Cargo shipments</p>
                        </div>
                    </div>
                    <div class="card stat-card">
                        <div class="stat-icon orange">
                            <i class="fas fa-anchor"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="vessels-in-port">8</h3>
                            <p>Vessels in port</p>
                        </div>
                    </div>
                    <div class="card stat-card">
                        <div class="stat-icon blue">
                            <i class="fas fa-tools"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="maintenance-tasks">5</h3>
                            <p>Maintenance Tasks</p>
                        </div>
                    </div>
                </div>

                <div class="section-header">
                    <h3 class="section-title">Recent Cargo Operations</h3>
                    <button class="btn btn-primary" id="view-all-btn">View All</button>
                </div>

                <div class="table-container">
                    <table id="recent-cargos-table">
                        <thead>
                            <tr>
                                <th>Cargo ID</th>
                                <th>Vessel</th>
                                <th>Origin</th>
                                <th>Destination</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Fleet Management Section -->
            <div id="fleet" class="section">
                <div class="section-header">
                    <h3 class="section-title">Vessel Fleet</h3>
                    <button class="btn btn-primary" id="add-vessel-btn"><i class="fas fa-plus"></i> Add New Vessel</button>
                </div>

                <div class="search-container">
                    <div class="search-box">
                        <input type="text" id="vessel-search" class="form-control" placeholder="Search by vessel name...">
                    </div>
                    <select id="vessel-type-filter" class="form-control" style="width: 200px;">
                        <option value="">All Types</option>
                        <option value="Container Ship">Container Ship</option>
                        <option value="Bulk Carrier">Bulk Carrier</option>
                        <option value="Tanker">Tanker</option>
                    </select>
                    <select id="vessel-status-filter" class="form-control" style="width: 200px;">
                        <option value="">All Statuses</option>
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                        <option value="Maintenance">Maintenance</option>
                    </select>
                    <button class="btn btn-primary" id="search-vessels-btn"><i class="fas fa-search"></i> Search</button>
                </div>

                <div class="table-container">
                    <table id="vessels-table">
                        <thead>
                            <tr>
                                <th>Vessel Name</th>
                                <th>Type</th>
                                <th>Year</th>
                                <th>Capacity (TEU)</th>
                                <th>Current Location</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Cargo Operations Section -->
            <div id="cargo" class="section">
                <div class="section-header">
                    <h3 class="section-title">Cargo Management</h3>
                    <button class="btn btn-primary" id="add-cargo-btn"><i class="fas fa-plus"></i> New Cargo</button>
                </div>

                <div class="tabs">
                    <div class="tab active" data-tab="booking">Booking</div>
                    <div class="tab" data-tab="allocation">Allocation</div>
                    <div class="tab" data-tab="load-unload">Load/Unload</div>
                </div>

                <div class="tab-content active" id="booking-tab">
                    <div class="form-container">
                        <h3 style="margin-bottom: 20px;">Cargo Booking</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="cargo-type">Cargo Type</label>
                                <select id="cargo-type" class="form-control" required>
                                    <option value="">Select Cargo Type</option>
                                    <option value="Container">Container</option>
                                    <option value="Bulk">Bulk</option>
                                    <option value="Liquid">Liquid</option>
                                    <option value="Reefer">Reefer</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="weight">Weight (tons)</label>
                                <input type="number" id="weight" class="form-control" placeholder="Enter weight" required>
                            </div>
                            <div class="form-group">
                                <label for="origin">Origin</label>
                                <input type="text" id="origin" class="form-control" placeholder="Enter origin" required>
                            </div>
                            <div class="form-group">
                                <label for="destination">Destination</label>
                                <input type="text" id="destination" class="form-control" placeholder="Enter destination" required>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="book-cargo-btn" style="margin-top: 20px;"><i class="fas fa-check"></i> Book Cargo</button>
                    </div>
                </div>

                <div class="tab-content" id="allocation-tab">
                    <div class="form-container">
                        <h3 style="margin-bottom: 20px;">Cargo Allocation to Vessels</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="cargo-select">Select Cargo</label>
                                <select id="cargo-select" class="form-control" required>
                                    <option value="">Select Cargo</option>
                                    <!-- Will be populated by JavaScript -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="vessel-select">Select Vessel</label>
                                <select id="vessel-select" class="form-control" required>
                                    <option value="">Select Vessel</option>
                                    <!-- Will be populated by JavaScript -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="loading-date">Loading Date</label>
                                <input type="date" id="loading-date" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="estimated-arrival">Estimated Arrival</label>
                                <input type="date" id="estimated-arrival" class="form-control" required>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="allocate-cargo-btn" style="margin-top: 20px;"><i class="fas fa-link"></i> Allocate Cargo</button>
                    </div>
                </div>

                <div class="tab-content" id="load-unload-tab">
                    <div class="form-container">
                        <h3 style="margin-bottom: 20px;">Cargo Load/Unload Operations</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="operation-type">Operation Type</label>
                                <select id="operation-type" class="form-control" required>
                                    <option value="Loading">Loading</option>
                                    <option value="Unloading">Unloading</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="cargo-operation">Select Cargo</label>
                                <select id="cargo-operation" class="form-control" required>
                                    <option value="">Select Cargo</option>
                                    <!-- Will be populated by JavaScript -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="operation-date">Operation Date</label>
                                <input type="date" id="operation-date" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="operation-status">Operation Status</label>
                                <select id="operation-status" class="form-control" required>
                                    <option value="Scheduled">Scheduled</option>
                                    <option value="In Progress">In Progress</option>
                                    <option value="Completed">Completed</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="save-operation-btn" style="margin-top: 20px;"><i class="fas fa-save"></i> Save Operation</button>
                    </div>
                </div>

                <div class="section-header" style="margin-top: 30px;">
                    <h3 class="section-title">Cargo List</h3>
                </div>

                <div class="table-container">
                    <table id="cargos-table">
                        <thead>
                            <tr>
                                <th>Cargo ID</th>
                                <th>Description</th>
                                <th>Weight (tons)</th>
                                <th>Origin</th>
                                <th>Destination</th>
                                <th>Status</th>
                                <th>Vessel</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Maintenance Section -->
            <div id="maintenance" class="section">
                <div class="section-header">
                    <h3 class="section-title">Vessel Maintenance</h3>
                    <button class="btn btn-primary" id="add-maintenance-btn"><i class="fas fa-plus"></i> Schedule Maintenance</button>
                </div>

                <div class="tabs">
                    <div class="tab active" data-tab="upcoming">Upcoming</div>
                    <div class="tab" data-tab="in-progress">In Progress</div>
                    <div class="tab" data-tab="history">History</div>
                </div>

                <div class="tab-content active" id="upcoming-tab">
                    <div class="table-container">
                        <table id="upcoming-maintenance-table">
                            <thead>
                                <tr>
                                    <th>Vessel</th>
                                    <th>Maintenance Type</th>
                                    <th>Scheduled Date</th>
                                    <th>Estimated Duration</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="tab-content" id="in-progress-tab">
                    <div class="table-container">
                        <table id="inprogress-maintenance-table">
                            <thead>
                                <tr>
                                    <th>Vessel</th>
                                    <th>Maintenance Type</th>
                                    <th>Start Date</th>
                                    <th>Estimated Completion</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="tab-content" id="history-tab">
                    <div class="table-container">
                        <table id="history-maintenance-table">
                            <thead>
                                <tr>
                                    <th>Vessel</th>
                                    <th>Maintenance Type</th>
                                    <th>Completed Date</th>
                                    <th>Duration</th>
                                    <th>Cost</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Accounting Section -->
            <div id="accounting" class="section">
                <div class="section-header">
                    <h3 class="section-title">Vessel Operations Accounting</h3>
                    <button class="btn btn-primary" id="generate-report-btn"><i class="fas fa-file-export"></i> Generate Report</button>
                </div>

                <div class="accounting-cards">
                    <div class="accounting-card">
                        <h3>Total Revenue</h3>
                        <div class="amount income" id="total-revenue">$2,548,750</div>
                        <p>Current Fiscal Year</p>
                    </div>
                    <div class="accounting-card">
                        <h3>Operating Costs</h3>
                        <div class="amount expense" id="operating-costs">$1,327,350</div>
                        <p>Current Fiscal Year</p>
                    </div>
                    <div class="accounting-card">
                        <h3>Net Profit</h3>
                        <div class="amount profit" id="net-profit">$1,221,400</div>
                        <p>Current Fiscal Year</p>
                    </div>
                </div>

                <div class="tabs">
                    <div class="tab active" data-tab="revenue">Revenue</div>
                    <div class="tab" data-tab="expenses">Expenses</div>
                    <div class="tab" data-tab="profitability">Profitability</div>
                </div>

                <div class="tab-content active" id="revenue-tab">
                    <div class="table-container">
                        <table id="revenue-table">
                            <thead>
                                <tr>
                                    <th>Vessel</th>
                                    <th>Q1 2023</th>
                                    <th>Q2 2023</th>
                                    <th>Q3 2023</th>
                                    <th>Q4 2023</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="tab-content" id="expenses-tab">
                    <div class="table-container">
                        <table id="expenses-table">
                            <thead>
                                <tr>
                                    <th>Expense Category</th>
                                    <th>Q1 2023</th>
                                    <th>Q2 2023</th>
                                    <th>Q3 2023</th>
                                    <th>Q4 2023</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="tab-content" id="profitability-tab">
                    <div class="table-container">
                        <table id="profitability-table">
                            <thead>
                                <tr>
                                    <th>Vessel</th>
                                    <th>Revenue</th>
                                    <th>Expenses</th>
                                    <th>Profit</th>
                                    <th>Margin</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Vessel Modal -->
    <div class="modal-overlay" id="vessel-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Register New Vessel</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="vessel-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="vessel-name">Vessel Name</label>
                        <input type="text" id="vessel-name" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="vessel-type">Vessel Type</label>
                        <select id="vessel-type" class="form-control" required>
                            <option value="">Select Type</option>
                            <option value="Container Ship">Container Ship</option>
                            <option value="Bulk Carrier">Bulk Carrier</option>
                            <option value="Tanker">Tanker</option>
                            <option value="Ro-Ro Vessel">Ro-Ro Vessel</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="year-built">Year Built</label>
                        <input type="number" id="year-built" class="form-control" required min="1950" max="2023">
                    </div>
                    <div class="form-group">
                        <label for="capacity">Capacity (TEU)</label>
                        <input type="number" id="capacity" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="flag">Flag</label>
                        <input type="text" id="flag" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="current-location">Current Location</label>
                        <input type="text" id="current-location" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="vessel-status">Status</label>
                        <select id="vessel-status" class="form-control" required>
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                            <option value="Maintenance">Maintenance</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 20px;"><i class="fas fa-save"></i> Register Vessel</button>
            </form>
        </div>
    </div>

    <!-- Maintenance Modal -->
    <div class="modal-overlay" id="maintenance-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Schedule Maintenance</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="maintenance-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="maintenance-vessel">Select Vessel</label>
                        <select id="maintenance-vessel" class="form-control" required>
                            <option value="">Select Vessel</option>
                            <!-- Will be populated by JavaScript -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="maintenance-type">Maintenance Type</label>
                        <select id="maintenance-type" class="form-control" required>
                            <option value="">Select Type</option>
                            <option value="Engine Maintenance">Engine Maintenance</option>
                            <option value="Hull Cleaning">Hull Cleaning</option>
                            <option value="Navigation System">Navigation System</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="maintenance-date">Scheduled Date</label>
                        <input type="date" id="maintenance-date" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="maintenance-duration">Estimated Duration (days)</label>
                        <input type="number" id="maintenance-duration" class="form-control" required min="1">
                    </div>
                    <div class="form-group">
                        <label for="maintenance-cost">Estimated Cost ($)</label>
                        <input type="number" id="maintenance-cost" class="form-control" required min="0">
                    </div>
                    <div class="form-group">
                        <label for="maintenance-description">Description</label>
                        <textarea id="maintenance-description" class="form-control" rows="3"></textarea>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 20px;"><i class="fas fa-calendar-check"></i> Schedule Maintenance</button>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-message">Operation completed successfully</span>
    </div>

    <script>
        // Data storage
        let vessels = JSON.parse(localStorage.getItem('vessels')) || [
            { id: 'VS-001', name: 'Atlantic Star', type: 'Container Ship', year: 2018, capacity: 15000, location: 'Pacific Ocean', status: 'Active' },
            { id: 'VS-002', name: 'Pacific Carrier', type: 'Container Ship', year: 2015, capacity: 12500, location: 'Rotterdam Port', status: 'Maintenance' },
            { id: 'VS-003', name: 'Mediterranean Voyager', type: 'Bulk Carrier', year: 2019, capacity: 8000, location: 'Atlantic Ocean', status: 'Active' },
            { id: 'VS-004', name: 'Indian Ocean', type: 'Tanker', year: 2016, capacity: 18000, location: 'Mumbai Port', status: 'Inactive' }
        ];

        let cargos = JSON.parse(localStorage.getItem('cargos')) || [
            { id: 'CG-7892', type: 'Container', weight: 120, origin: 'Shanghai', destination: 'Los Angeles', status: 'In Transit', vessel: 'VS-001' },
            { id: 'CG-6541', type: 'Container', weight: 85, origin: 'Rotterdam', destination: 'Singapore', status: 'Loading', vessel: 'VS-002' },
            { id: 'CG-3218', type: 'Bulk', weight: 150, origin: 'Hamburg', destination: 'New York', status: 'In Transit', vessel: 'VS-003' },
            { id: 'CG-9876', type: 'Liquid', weight: 200, origin: 'Dubai', destination: 'Mumbai', status: 'Unloading', vessel: 'VS-004' }
        ];

        let maintenanceTasks = JSON.parse(localStorage.getItem('maintenanceTasks')) || [
            { id: 'MT-001', vesselId: 'VS-002', vesselName: 'Pacific Carrier', type: 'Engine Overhaul', scheduledDate: '2023-10-15', duration: 14, status: 'Scheduled', cost: 125000 },
            { id: 'MT-002', vesselId: 'VS-004', vesselName: 'Indian Ocean', type: 'Hull Cleaning', scheduledDate: '2023-10-20', duration: 3, status: 'Scheduled', cost: 25000 },
            { id: 'MT-003', vesselId: 'VS-001', vesselName: 'Atlantic Star', type: 'Navigation System Upgrade', startDate: '2023-10-05', estimatedCompletion: '2023-10-12', duration: 7, status: 'In Progress', cost: 85000 }
        ];

        let accountingData = JSON.parse(localStorage.getItem('accountingData')) || {
            revenue: {
                'VS-001': { Q1: 325400, Q2: 356800, Q3: 372500, Q4: 395200 },
                'VS-002': { Q1: 285700, Q2: 302500, Q3: 315300, Q4: 328100 },
                'VS-003': { Q1: 198500, Q2: 210300, Q3: 225400, Q4: 232800 }
            },
            expenses: {
                fuel: { Q1: 285400, Q2: 296800, Q3: 312500, Q4: 325200 },
                maintenance: { Q1: 85700, Q2: 92500, Q3: 105300, Q4: 88100 },
                portFees: { Q1: 68500, Q2: 70300, Q3: 75400, Q4: 72800 },
                crew: { Q1: 120500, Q2: 125300, Q3: 130400, Q4: 132800 }
            }
        };

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('vessels', JSON.stringify(vessels));
            localStorage.setItem('cargos', JSON.stringify(cargos));
            localStorage.setItem('maintenanceTasks', JSON.stringify(maintenanceTasks));
            localStorage.setItem('accountingData', JSON.stringify(accountingData));
        }

        // Show toast notification
        function showToast(message, isSuccess = true) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            toastMessage.textContent = message;
            toast.className = isSuccess ? 'toast success show' : 'toast error show';
            
            setTimeout(() => {
                toast.className = toast.className.replace('show', '');
            }, 3000);
        }

        // Generate unique ID
        function generateId(prefix) {
            return `${prefix}-${Math.floor(1000 + Math.random() * 9000)}`;
        }

        // Navigation functionality
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                // Update active nav item
                document.querySelectorAll('.nav-item').forEach(nav => {
                    nav.classList.remove('active');
                });
                this.classList.add('active');
                
                // Show corresponding section
                const sectionId = this.getAttribute('data-section');
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(sectionId).classList.add('active');
                
                // Update section title
                document.getElementById('section-title').textContent = 
                    this.querySelector('span').textContent;
                
                // Refresh section data
                refreshSectionData(sectionId);
            });
        });

        // Refresh section data
        function refreshSectionData(sectionId) {
            switch(sectionId) {
                case 'dashboard':
                    refreshDashboard();
                    break;
                case 'fleet':
                    refreshFleet();
                    break;
                case 'cargo':
                    refreshCargo();
                    break;
                case 'maintenance':
                    refreshMaintenance();
                    break;
                case 'accounting':
                    refreshAccounting();
                    break;
            }
        }

        // Tab functionality
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabName = this.getAttribute('data-tab');
                const tabContainer = this.closest('.tabs');
                
                // Update active tab
                tabContainer.querySelectorAll('.tab').forEach(t => {
                    t.classList.remove('active');
                });
                this.classList.add('active');
                
                // Show corresponding tab content
                const tabContentId = `${tabName}-tab`;
                tabContainer.parentElement.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tabContentId).classList.add('active');
            });
        });

        // Modal functionality
        const vesselModal = document.getElementById('vessel-modal');
        const maintenanceModal = document.getElementById('maintenance-modal');
        const addVesselBtn = document.getElementById('add-vessel-btn');
        const addMaintenanceBtn = document.getElementById('add-maintenance-btn');
        const closeModalBtns = document.querySelectorAll('.close-modal');

        addVesselBtn.addEventListener('click', () => {
            vesselModal.style.display = 'flex';
            document.getElementById('vessel-form').reset();
        });

        addMaintenanceBtn.addEventListener('click', () => {
            maintenanceModal.style.display = 'flex';
            document.getElementById('maintenance-form').reset();
            
            // Populate vessels dropdown
            const vesselSelect = document.getElementById('maintenance-vessel');
            vesselSelect.innerHTML = '<option value="">Select Vessel</option>';
            vessels.forEach(vessel => {
                if (vessel.status !== 'Maintenance') {
                    const option = document.createElement('option');
                    option.value = vessel.id;
                    option.textContent = `${vessel.name} (${vessel.type})`;
                    vesselSelect.appendChild(option);
                }
            });
        });

        closeModalBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                vesselModal.style.display = 'none';
                maintenanceModal.style.display = 'none';
            });
        });

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === vesselModal) {
                vesselModal.style.display = 'none';
            }
            if (e.target === maintenanceModal) {
                maintenanceModal.style.display = 'none';
            }
        });

        // Form submission handlers
        document.getElementById('vessel-form').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const newVessel = {
                id: generateId('VS'),
                name: document.getElementById('vessel-name').value,
                type: document.getElementById('vessel-type').value,
                year: parseInt(document.getElementById('year-built').value),
                capacity: parseInt(document.getElementById('capacity').value),
                location: document.getElementById('current-location').value,
                status: document.getElementById('vessel-status').value
            };
            
            vessels.push(newVessel);
            saveData();
            refreshFleet();
            refreshDashboard();
            
            vesselModal.style.display = 'none';
            showToast('Vessel registered successfully!');
        });

        document.getElementById('maintenance-form').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const vesselId = document.getElementById('maintenance-vessel').value;
            const vessel = vessels.find(v => v.id === vesselId);
            
            const newMaintenance = {
                id: generateId('MT'),
                vesselId: vesselId,
                vesselName: vessel.name,
                type: document.getElementById('maintenance-type').value,
                scheduledDate: document.getElementById('maintenance-date').value,
                duration: parseInt(document.getElementById('maintenance-duration').value),
                cost: parseInt(document.getElementById('maintenance-cost').value),
                status: 'Scheduled',
                description: document.getElementById('maintenance-description').value
            };
            
            // Update vessel status to Maintenance
            vessel.status = 'Maintenance';
            
            maintenanceTasks.push(newMaintenance);
            saveData();
            refreshMaintenance();
            refreshFleet();
            refreshDashboard();
            
            maintenanceModal.style.display = 'none';
            showToast('Maintenance scheduled successfully!');
        });

        document.getElementById('book-cargo-btn').addEventListener('click', (e) => {
            e.preventDefault();
            
            const newCargo = {
                id: generateId('CG'),
                type: document.getElementById('cargo-type').value,
                weight: parseInt(document.getElementById('weight').value),
                origin: document.getElementById('origin').value,
                destination: document.getElementById('destination').value,
                status: 'Booked',
                vessel: null
            };
            
            cargos.push(newCargo);
            saveData();
            refreshCargo();
            refreshDashboard();
            
            document.getElementById('booking-tab').querySelector('form').reset();
            showToast('Cargo booked successfully!');
        });

        document.getElementById('allocate-cargo-btn').addEventListener('click', (e) => {
            e.preventDefault();
            
            const cargoId = document.getElementById('cargo-select').value;
            const vesselId = document.getElementById('vessel-select').value;
            const loadingDate = document.getElementById('loading-date').value;
            const estimatedArrival = document.getElementById('estimated-arrival').value;
            
            const cargo = cargos.find(c => c.id === cargoId);
            const vessel = vessels.find(v => v.id === vesselId);
            
            if (cargo && vessel) {
                cargo.vessel = vesselId;
                cargo.status = 'Loading';
                cargo.loadingDate = loadingDate;
                cargo.estimatedArrival = estimatedArrival;
                
                saveData();
                refreshCargo();
                showToast(`Cargo allocated to ${vessel.name} successfully!`);
            }
        });

        document.getElementById('save-operation-btn').addEventListener('click', (e) => {
            e.preventDefault();
            
            const cargoId = document.getElementById('cargo-operation').value;
            const operationType = document.getElementById('operation-type').value;
            const operationDate = document.getElementById('operation-date').value;
            const operationStatus = document.getElementById('operation-status').value;
            
            const cargo = cargos.find(c => c.id === cargoId);
            
            if (cargo) {
                if (operationType === 'Loading') {
                    cargo.loadingDate = operationDate;
                    if (operationStatus === 'Completed') {
                        cargo.status = 'In Transit';
                    }
                } else {
                    cargo.unloadingDate = operationDate;
                    if (operationStatus === 'Completed') {
                        cargo.status = 'Delivered';
                    }
                }
                
                saveData();
                refreshCargo();
                showToast(`Operation ${operationType.toLowerCase()} status updated successfully!`);
            }
        });

        document.getElementById('search-vessels-btn').addEventListener('click', () => {
            refreshFleet();
        });

        document.getElementById('view-all-btn').addEventListener('click', () => {
            document.querySelectorAll('.nav-item').forEach(nav => {
                nav.classList.remove('active');
            });
            document.querySelector('[data-section="cargo"]').classList.add('active');
            
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById('cargo').classList.add('active');
            
            document.getElementById('section-title').textContent = 'Cargo Operations';
        });

        document.getElementById('generate-report-btn').addEventListener('click', () => {
            // In a real application, this would generate a PDF or Excel report
            showToast('Report generated successfully! Download will start shortly.');
        });

        // Refresh functions for each section
        function refreshDashboard() {
            // Update stats
            document.getElementById('total-vessels').textContent = vessels.length;
            document.getElementById('total-cargos').textContent = cargos.length;
            document.getElementById('vessels-in-port').textContent = vessels.filter(v => v.location.includes('Port')).length;
            document.getElementById('maintenance-tasks').textContent = maintenanceTasks.filter(m => m.status === 'Scheduled' || m.status === 'In Progress').length;
            
            // Update recent cargos table
            const recentCargosTable = document.getElementById('recent-cargos-table').querySelector('tbody');
            recentCargosTable.innerHTML = '';
            
            const recentCargos = cargos.slice(0, 5);
            recentCargos.forEach(cargo => {
                const vessel = vessels.find(v => v.id === cargo.vessel) || { name: 'Not Assigned' };
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${cargo.id}</td>
                    <td>${vessel.name}</td>
                    <td>${cargo.origin}</td>
                    <td>${cargo.destination}</td>
                    <td><span class="status ${cargo.status.toLowerCase().replace(' ', '-')}">${cargo.status}</span></td>
                    <td>
                        <button class="action-btn"><i class="fas fa-eye"></i></button>
                        <button class="action-btn edit"><i class="fas fa-edit"></i></button>
                    </td>
                `;
                recentCargosTable.appendChild(row);
            });
        }

        function refreshFleet() {
            const searchTerm = document.getElementById('vessel-search').value.toLowerCase();
            const typeFilter = document.getElementById('vessel-type-filter').value;
            const statusFilter = document.getElementById('vessel-status-filter').value;
            
            // Filter vessels
            const filteredVessels = vessels.filter(vessel => {
                const matchesSearch = vessel.name.toLowerCase().includes(searchTerm);
                const matchesType = typeFilter ? vessel.type === typeFilter : true;
                const matchesStatus = statusFilter ? vessel.status === statusFilter : true;
                
                return matchesSearch && matchesType && matchesStatus;
            });
            
            // Update vessels table
            const vesselsTable = document.getElementById('vessels-table').querySelector('tbody');
            vesselsTable.innerHTML = '';
            
            filteredVessels.forEach(vessel => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${vessel.name}</td>
                    <td>${vessel.type}</td>
                    <td>${vessel.year}</td>
                    <td>${vessel.capacity.toLocaleString()}</td>
                    <td>${vessel.location}</td>
                    <td><span class="status ${vessel.status.toLowerCase()}">${vessel.status}</span></td>
                    <td>
                        <button class="action-btn"><i class="fas fa-eye"></i></button>
                        <button class="action-btn edit"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete" data-id="${vessel.id}"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                vesselsTable.appendChild(row);
            });
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.action-btn.delete').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const vesselId = e.currentTarget.getAttribute('data-id');
                    if (confirm('Are you sure you want to delete this vessel?')) {
                        vessels = vessels.filter(v => v.id !== vesselId);
                        saveData();
                        refreshFleet();
                        refreshDashboard();
                        showToast('Vessel deleted successfully!');
                    }
                });
            });
        }

        function refreshCargo() {
            // Update cargo dropdowns
            const cargoSelect = document.getElementById('cargo-select');
            const cargoOperation = document.getElementById('cargo-operation');
            
            cargoSelect.innerHTML = '<option value="">Select Cargo</option>';
            cargoOperation.innerHTML = '<option value="">Select Cargo</option>';
            
            cargos.filter(c => !c.vessel).forEach(cargo => {
                const option = document.createElement('option');
                option.value = cargo.id;
                option.textContent = `${cargo.id} (${cargo.type}, ${cargo.origin} to ${cargo.destination})`;
                cargoSelect.appendChild(option);
            });
            
            cargos.forEach(cargo => {
                const option = document.createElement('option');
                option.value = cargo.id;
                option.textContent = `${cargo.id} (${cargo.type}, ${cargo.origin} to ${cargo.destination})`;
                cargoOperation.appendChild(option);
            });
            
            // Update vessel dropdown
            const vesselSelect = document.getElementById('vessel-select');
            vesselSelect.innerHTML = '<option value="">Select Vessel</option>';
            
            vessels.filter(v => v.status === 'Active').forEach(vessel => {
                const option = document.createElement('option');
                option.value = vessel.id;
                option.textContent = `${vessel.name} (${vessel.type})`;
                vesselSelect.appendChild(option);
            });
            
            // Update cargos table
            const cargosTable = document.getElementById('cargos-table').querySelector('tbody');
            cargosTable.innerHTML = '';
            
            cargos.forEach(cargo => {
                const vessel = vessels.find(v => v.id === cargo.vessel) || { name: 'Not Assigned' };
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${cargo.id}</td>
                    <td>${cargo.type}</td>
                    <td>${cargo.weight}</td>
                    <td>${cargo.origin}</td>
                    <td>${cargo.destination}</td>
                    <td><span class="status ${cargo.status.toLowerCase().replace(' ', '-')}">${cargo.status}</span></td>
                    <td>${vessel.name}</td>
                    <td>
                        <button class="action-btn"><i class="fas fa-eye"></i></button>
                        <button class="action-btn edit"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete" data-id="${cargo.id}"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                cargosTable.appendChild(row);
            });
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.action-btn.delete').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const cargoId = e.currentTarget.getAttribute('data-id');
                    if (confirm('Are you sure you want to delete this cargo?')) {
                        cargos = cargos.filter(c => c.id !== cargoId);
                        saveData();
                        refreshCargo();
                        refreshDashboard();
                        showToast('Cargo deleted successfully!');
                    }
                });
            });
        }

        function refreshMaintenance() {
            // Update maintenance tables
            const upcomingTable = document.getElementById('upcoming-maintenance-table').querySelector('tbody');
            const inProgressTable = document.getElementById('inprogress-maintenance-table').querySelector('tbody');
            const historyTable = document.getElementById('history-maintenance-table').querySelector('tbody');
            
            upcomingTable.innerHTML = '';
            inProgressTable.innerHTML = '';
            historyTable.innerHTML = '';
            
            maintenanceTasks.forEach(task => {
                const row = document.createElement('tr');
                
                if (task.status === 'Scheduled') {
                    row.innerHTML = `
                        <td>${task.vesselName}</td>
                        <td>${task.type}</td>
                        <td>${task.scheduledDate}</td>
                        <td>${task.duration} days</td>
                        <td><span class="status pending">${task.status}</span></td>
                        <td>
                            <button class="action-btn start-maintenance" data-id="${task.id}"><i class="fas fa-play"></i></button>
                            <button class="action-btn edit"><i class="fas fa-edit"></i></button>
                            <button class="action-btn delete" data-id="${task.id}"><i class="fas fa-trash"></i></button>
                        </td>
                    `;
                    upcomingTable.appendChild(row);
                } else if (task.status === 'In Progress') {
                    row.innerHTML = `
                        <td>${task.vesselName}</td>
                        <td>${task.type}</td>
                        <td>${task.startDate}</td>
                        <td>${task.estimatedCompletion}</td>
                        <td><span class="status active">${task.status}</span></td>
                        <td>
                            <button class="action-btn complete-maintenance" data-id="${task.id}"><i class="fas fa-check"></i></button>
                            <button class="action-btn edit"><i class="fas fa-edit"></i></button>
                        </td>
                    `;
                    inProgressTable.appendChild(row);
                } else if (task.status === 'Completed') {
                    row.innerHTML = `
                        <td>${task.vesselName}</td>
                        <td>${task.type}</td>
                        <td>${task.completedDate}</td>
                        <td>${task.duration} days</td>
                        <td>$${task.cost.toLocaleString()}</td>
                        <td>
                            <button class="action-btn"><i class="fas fa-eye"></i></button>
                        </td>
                    `;
                    historyTable.appendChild(row);
                }
            });
            
            // Add event listeners to action buttons
            document.querySelectorAll('.start-maintenance').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const taskId = e.currentTarget.getAttribute('data-id');
                    const task = maintenanceTasks.find(t => t.id === taskId);
                    
                    if (task) {
                        task.status = 'In Progress';
                        task.startDate = new Date().toISOString().split('T')[0];
                        
                        // Calculate estimated completion date
                        const startDate = new Date(task.startDate);
                        const completionDate = new Date(startDate);
                        completionDate.setDate(completionDate.getDate() + task.duration);
                        task.estimatedCompletion = completionDate.toISOString().split('T')[0];
                        
                        saveData();
                        refreshMaintenance();
                        showToast('Maintenance started successfully!');
                    }
                });
            });
            
            document.querySelectorAll('.complete-maintenance').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const taskId = e.currentTarget.getAttribute('data-id');
                    const task = maintenanceTasks.find(t => t.id === taskId);
                    
                    if (task) {
                        task.status = 'Completed';
                        task.completedDate = new Date().toISOString().split('T')[0];
                        
                        // Update vessel status back to Active
                        const vessel = vessels.find(v => v.id === task.vesselId);
                        if (vessel) {
                            vessel.status = 'Active';
                        }
                        
                        saveData();
                        refreshMaintenance();
                        refreshFleet();
                        refreshDashboard();
                        showToast('Maintenance completed successfully!');
                    }
                });
            });
            
            document.querySelectorAll('.action-btn.delete').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const taskId = e.currentTarget.getAttribute('data-id');
                    if (confirm('Are you sure you want to delete this maintenance task?')) {
                        maintenanceTasks = maintenanceTasks.filter(t => t.id !== taskId);
                        saveData();
                        refreshMaintenance();
                        showToast('Maintenance task deleted successfully!');
                    }
                });
            });
        }

        function refreshAccounting() {
            // Calculate totals
            let totalRevenue = 0;
            let totalExpenses = 0;
            
            for (const vesselId in accountingData.revenue) {
                for (const quarter in accountingData.revenue[vesselId]) {
                    totalRevenue += accountingData.revenue[vesselId][quarter];
                }
            }
            
            for (const category in accountingData.expenses) {
                for (const quarter in accountingData.expenses[category]) {
                    totalExpenses += accountingData.expenses[category][quarter];
                }
            }
            
            const netProfit = totalRevenue - totalExpenses;
            
            // Update accounting cards
            document.getElementById('total-revenue').textContent = `$${totalRevenue.toLocaleString()}`;
            document.getElementById('operating-costs').textContent = `$${totalExpenses.toLocaleString()}`;
            document.getElementById('net-profit').textContent = `$${netProfit.toLocaleString()}`;
            
            // Update revenue table
            const revenueTable = document.getElementById('revenue-table').querySelector('tbody');
            revenueTable.innerHTML = '';
            
            for (const vesselId in accountingData.revenue) {
                const vessel = vessels.find(v => v.id === vesselId);
                if (vessel) {
                    const revenue = accountingData.revenue[vesselId];
                    const total = revenue.Q1 + revenue.Q2 + revenue.Q3 + revenue.Q4;
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${vessel.name}</td>
                        <td>$${revenue.Q1.toLocaleString()}</td>
                        <td>$${revenue.Q2.toLocaleString()}</td>
                        <td>$${revenue.Q3.toLocaleString()}</td>
                        <td>$${revenue.Q4.toLocaleString()}</td>
                        <td>$${total.toLocaleString()}</td>
                    `;
                    revenueTable.appendChild(row);
                }
            }
            
            // Update expenses table
            const expensesTable = document.getElementById('expenses-table').querySelector('tbody');
            expensesTable.innerHTML = '';
            
            for (const category in accountingData.expenses) {
                const expenses = accountingData.expenses[category];
                const total = expenses.Q1 + expenses.Q2 + expenses.Q3 + expenses.Q4;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${category.charAt(0).toUpperCase() + category.slice(1)}</td>
                    <td>$${expenses.Q1.toLocaleString()}</td>
                    <td>$${expenses.Q2.toLocaleString()}</td>
                    <td>$${expenses.Q3.toLocaleString()}</td>
                    <td>$${expenses.Q4.toLocaleString()}</td>
                    <td>$${total.toLocaleString()}</td>
                `;
                expensesTable.appendChild(row);
            }
            
            // Update profitability table
            const profitabilityTable = document.getElementById('profitability-table').querySelector('tbody');
            profitabilityTable.innerHTML = '';
            
            for (const vesselId in accountingData.revenue) {
                const vessel = vessels.find(v => v.id === vesselId);
                if (vessel) {
                    const revenue = accountingData.revenue[vesselId];
                    const totalRevenue = revenue.Q1 + revenue.Q2 + revenue.Q3 + revenue.Q4;
                    
                    // Calculate vessel expenses (simplified - 40% of revenue)
                    const totalExpenses = totalRevenue * 0.4;
                    const profit = totalRevenue - totalExpenses;
                    const margin = (profit / totalRevenue) * 100;
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${vessel.name}</td>
                        <td>$${totalRevenue.toLocaleString()}</td>
                        <td>$${totalExpenses.toLocaleString()}</td>
                        <td>$${profit.toLocaleString()}</td>
                        <td>${margin.toFixed(1)}%</td>
                    `;
                    profitabilityTable.appendChild(row);
                }
            }
        }

        // Initialize the application
        function initApp() {
            saveData(); // Save initial data
            refreshDashboard(); // Load dashboard data
        }

        // Run initialization when page loads
        window.addEventListener('load', initApp);
    </script>
</body>
</html>